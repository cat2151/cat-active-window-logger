# cat-active-window-logger
オープンソース、自分の用途にマッチした挙動のロガー、を楽に作れるかの検証用

# 状況
実験段階です

# ざっくりブレインストーミング

# ロードマップ案のブレインストーミング
- title変動 のlistup
    - イメージ
        - toml出力
            - output例
                - `[[変動titleその1]]`
                    - `titles = [ 'a1', 'a2' ]`
                    - `process_name : 'a.exe'`
                    - `process_id : 12345`
    - 用途
        - 変動titleの有無を可視化し、対策優先度を可視化する
- 全titleの列挙
    - これまでの課題
        - log tomlは取得できた。さてどのようなtitleがあるか？の網羅、把握、ができていない
    - 対策
        - 可視化する
    - 方法
        - toml output 、titleの一覧
        - log加工部
        - 専用py、新規py
    - イメージ
        - toml出力
            - メリット、情報が多いぶん、トラブル時のヒントを増やせる
            - output例
                - `[[titleその1]]`
                    - `title = 'a'`
                    - `process_name : 'a.exe'`
                    - `process_id : 12345`
                    - ※時刻情報はひとまずカットする、それは別途切り分けて実施予定
        - txt出力
            - メリット、行数が少なく網羅性が高い
            - output例
                - `a1`
                - `a2`

# 構成案のブレインストーミング
- 分解
    - 常駐部
        - logger
        - checker
    - log加工部
        - input : log
        - process : いろいろな条件でフィルタリング等
            - 時間
                - 直近30分だけ
            - 要素
                - window titleだけ
        - output : 加工された新たなformatのlog、あるいはサマリ
            - 可視化された、比較的可読性の高いもの
                - デバッグ用に可読性を向上させたもの等
    - viewer部
        - グラフ表示、pythonのグラフ表示ライブラリを使う想定
    - アプリそれぞれを疎結合にし、中間ファイルで接続する
        - メリット : forkした人が、必要なところだけ別内容に変更できる
        - 備忘 : 外部プラグインで拡張できるような仕組み、を検討するのはもっと大規模で多機能になってからのイメージ

# 機能の補足
- checker
    - 指定windowがactiveになったかをcheckし、
        - 指定した名前付きパイプに、指定messageをsendする。
        - いずれもtomlで指定する。
    - 運用例：
        - display-image-1sec にsend messageして、1秒間、画像表示する。
            - 用途は、指定windowをactiveにしたことを別観点から演出することで楽しむ用。

# 今後、ブレインストーミング
- titleとprocessを元に、正規表現で、tagづけ
    - 用途、集計サポート用、可視化用、ふわっと
    - イメージ、in tomlにtag付与して、out tomlに出力する

# 備忘、ブレインストーミング
- hwnd 等の一見logging不要そうなデータの用途
    - ノウハウ用
        - titleが頻繁に変わる場合のヒントになるか？の検証用
        - ひとまず、ねんのため
- TOMLにした理由
    - 追記処理がシンプル、可読性が高い
        - jsonの場合、追記処理が複雑になる
            - ほしいのは、時刻ごとの、配列の追記
        - tsv等の場合、可読性が（TOMLよりは）低い
            - ほしいのは、要素ごとに要素名もlogging
                - なぜなら開発中に各種中間ファイルをtestしやすい（読みやすい）

# 備忘、いろいろ
- log rotation部
    - loggerと切り分ける
        - いろいろな仕様がありうるので、userごとに任意のrotateを可能に
            - 実際はrotateせずに圧縮の運用が多い想定
    - 必要になるまでは保留とし、優先度を下げ、issueをシンプルにする : [issue #10](./issue-notes/10.md)
- 対象user
    - 自分only
    - 自分以外のuserはスコープ外とする
        - このprojectはそうしないとしがらみで止まってしまう、と判断した
    - [issue #9](./issue-notes/9.md)
