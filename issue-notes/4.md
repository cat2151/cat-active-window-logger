# issue 次のwindowに切り替わるまでの時間のlog、を入力とし、tomlで指定した条件例えばまずはprocess_nameでgroupingした合計時間logを出力する #4
[issues #4](https://github.com/cat2151/cat-active-window-logger/issues/4)

# これまでの課題
- 例えば何分SNSをしていたかがわからない

# 前提
- [issues #3](./3.md)

# 対策案
- 時間のlog（時刻のlogを加工したもの）が得られた前提で、
- それを例えばprocess_name chrome.exe でgroupingする
- でcrhome.exeの合計時間のlogを出力する
- もちろん、これだけでは、何分SNSしていたかを知るには不足
    - 何が不足か、次の手はどれがいいか、の可視化のための検証である
        - 例えば、より細かいgrouping条件や、ロジックが必要な想定
            - それらを今の段階から想定するよりは、
                - まずデータを取ってからのほうがスムーズである想定
- まずハードコーディングでagentに実装させる
- のち仕様変更してagentに実装させる。issues 3 と同じ手法。

# 重要事項
- inputは、
    - active time log、つまり「次のwindowに切り替わるまでの時間のlog」である。
    - logの場所は例えば、以下である：
        - `logs_enhanced/active_window_log_20250920_enhanced.toml`
    - active time logは、
        - loggerのlogを、
        - src/log_enhance_active_time/add_active_time.py に入力して得られる。
    - つまり、当機能に active time logが入力された時点で、
        - 各processのactive timeは算出済みであり、
        - 当機能で新たに算出してはいけない。仕様のムダである。
    - まず、add_active_time.py の出力フォーマットを把握し、
        - それを計画に反映すること。
- 設定tomlは生成しない。「今後のための実装」も実装しない。ムダに複雑にするだけなので。YAGNI違反しない。
    - まず、`process_name = "chrome.exe"` のみに絞って、`elapsed_time = "00:00:01"`等を集計する、
    - それだけのpyを実装すること。

# どうする？
- 上記を日次バッチでprompt生成させ、agentに投げる

# close条件は？
- chromeを1日何分使っていたか、がlogに出力されること
    - それより細かい条件は別issueに切り分ける

# 結果
- promptは変更し、agentに投げた
- context不足によるハルシネーションが発生したので、当mdをメンテした
- 再度agentに投げた
- code生成させた
- レビューして人力で修正した
- 設定tomlを使うよう仕様変更し、agentに実装への反映をさせた
- レビューして人力で修正した（主に不要なcommentの削除、エラー握り潰しをやめ早期エラー終了で問題検知）
- test green

# closeとする
